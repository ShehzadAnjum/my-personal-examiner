# Implementation Plan: Teaching Page - PhD-Level Concept Explanations

**Branch**: `005-teaching-page` | **Date**: 2025-12-23 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/005-teaching-page/spec.md`

**Note**: This template is filled in by the `/sp.plan` command. See `.specify/templates/commands/plan.md` for the execution workflow.

## Summary

The Teaching Page feature provides students with PhD-level explanations of Economics 9708 syllabus concepts through an interactive web interface. Students can browse/search syllabus topics, request comprehensive explanations from the Teacher Agent (backend AI), and bookmark explanations for future review. The frontend displays explanations with collapsible sections (examples, misconceptions, practice problems), clear typography, and accessible navigation. Backend APIs already exist and are operational (GET /api/teaching/syllabus, POST /api/teaching/explain, GET /api/teaching/explanations).

**Technical Approach**: Reuse established patterns from 004-coaching-page (Next.js 16 App Router, React 19, TanStack Query 5.62+, shadcn/ui). Implement 3 main pages: (1) Topic Browser/Search (P2), (2) Explanation View (P1), (3) Saved Explanations (P3). Use TanStack Query for server state with 5-minute cache for explanations. Leverage ChatScope patterns for collapsible sections and clean content layout. No new backend work required—all APIs operational.

## Technical Context

**Language/Version**: TypeScript 5.7+ (Next.js 16+, React 19)
**Primary Dependencies**: Next.js 16 App Router, React 19, shadcn/ui, Tailwind CSS 4, TanStack Query 5.62+, Lucide React (icons)
**Storage**: PostgreSQL via REST API calls (backend already implemented)
**Testing**: Jest 29+ (unit tests for components), Playwright 1.49+ (E2E tests)
**Target Platform**: Web browsers (Chrome/Firefox/Safari, desktop + mobile responsive)
**Project Type**: Web application (frontend only—backend APIs already exist)
**Performance Goals**: <10 seconds for AI explanation generation (95% of requests), >90 Lighthouse accessibility score, <3 seconds initial page load
**Constraints**: WCAG 2.1 AA accessibility compliance, responsive design (375px minimum width), TanStack Query 5-minute cache for explanations
**Scale/Scope**: Economics 9708 syllabus (~200 topics), unlimited students (multi-tenant), 3 user stories (P1: View explanation, P2: Browse/search, P3: Bookmark)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

✅ **Principle I: Subject Accuracy** - All explanations generated by Teacher Agent aligned with Economics 9708 syllabus. SyllabusPoint data already verified against Cambridge specifications.

✅ **Principle II: A* Standard Marking** - N/A (teaching page displays explanations, not marking student work). Teacher Agent prompts enforce PhD-level pedagogy.

✅ **Principle III: Syllabus Synchronization** - Uses existing SyllabusPoint database (already synchronized monthly per Phase II completion).

✅ **Principle IV: Spec-Driven Development** - Spec created via `/sp.specify` (/specs/005-teaching-page/spec.md exists). Plan created via `/sp.plan` (this file).

✅ **Principle V: Multi-Tenant Isolation** - All API calls include JWT authentication with student_id. Bookmarked explanations filtered by student_id in backend.

✅ **Principle VI: Constructive Feedback** - N/A (no marking/feedback on teaching page). Applies to marking features only.

✅ **Principle VII: Phase Boundaries** - Part of Phase IV (Web UI). Coaching page (004) complete and merged. Teaching page is independent feature within same phase.

✅ **Principle VIII: Question Bank Quality** - N/A (not adding questions, only explaining existing syllabus topics).

✅ **Principle IX: SpecKitPlus Workflow** - Following mandatory sequence: /sp.specify ✅ → /sp.plan (in progress) → /sp.tasks (next) → /sp.implement.

✅ **Principle X: Official Skills Priority** - Checked Anthropic catalog. No official skill for teaching page UI. Using web-artifacts-builder patterns from 004-coaching-page precedent.

✅ **Principle XI: CLAUDE.md Hierarchy** - Will update `specs/phase-4-web-ui/CLAUDE.md` if teaching-page requires >50 lines of instructions (likely yes—will add section).

✅ **Principle XII: PMP Agent** - PROJECT_STATE.md tracking feature progress. TASK_TREE.md will be updated with 005-teaching-page tasks after `/sp.tasks`.

**GATE STATUS**: ✅ **PASS** - No constitutional violations. All principles satisfied or not applicable.

## Project Structure

### Documentation (this feature)

```text
specs/005-teaching-page/
├── spec.md              # Feature specification (/sp.specify output) ✅
├── plan.md              # This file (/sp.plan output) ⏳
├── research.md          # Phase 0 output (to be created)
├── data-model.md        # Phase 1 output (to be created)
├── quickstart.md        # Phase 1 output (to be created)
├── contracts/           # Phase 1 output (to be created)
│   ├── api-endpoints.md # Document existing backend APIs
│   └── ui-components.md # Component contracts and props
├── checklists/          # Quality validation ✅
│   └── requirements.md  # Spec quality checklist (complete)
└── tasks.md             # Phase 2 output (/sp.tasks - not yet created)
```

### Source Code (repository root)

```text
frontend/                                    # Next.js 16 App Router
├── app/
│   ├── (dashboard)/
│   │   └── teaching/                        # NEW: Teaching page routes
│   │       ├── page.tsx                     # Main teaching page (topic browser + search)
│   │       ├── [topicId]/                   # Dynamic route for explanations
│   │       │   └── page.tsx                 # Explanation view page
│   │       ├── saved/                       # Saved explanations page
│   │       │   └── page.tsx                 # Bookmarked explanations list
│   │       └── error.tsx                    # Error boundary for teaching routes
│   └── providers.tsx                        # TanStack Query provider (existing)
│
├── components/
│   ├── teaching/                            # NEW: Teaching-specific components
│   │   ├── TopicBrowser.tsx                 # Hierarchical topic tree (AS/A2, Papers)
│   │   ├── TopicSearch.tsx                  # Search bar + results
│   │   ├── ExplanationView.tsx              # Full explanation display
│   │   ├── ExplanationSection.tsx           # Collapsible section component
│   │   ├── BookmarkButton.tsx               # Bookmark/unbookmark action
│   │   ├── SavedExplanationsList.tsx        # List of bookmarked explanations
│   │   ├── TopicCard.tsx                    # Topic preview card
│   │   ├── ExplanationSkeleton.tsx          # Loading state for explanations
│   │   └── TopicSearchSkeleton.tsx          # Loading state for search
│   └── ui/                                  # shadcn/ui components (existing)
│       ├── accordion.tsx                    # For collapsible sections (existing)
│       ├── card.tsx                         # For topic cards (existing)
│       ├── input.tsx                        # For search bar (existing)
│       ├── button.tsx                       # For bookmark action (existing)
│       ├── skeleton.tsx                     # Loading states (existing from 004)
│       └── toast.tsx                        # Error notifications (existing from 004)
│
├── lib/
│   ├── api/
│   │   └── teaching.ts                      # NEW: API client for teaching endpoints
│   ├── hooks/
│   │   ├── useTopics.tsx                    # NEW: TanStack Query hook for topics
│   │   ├── useExplanation.tsx               # NEW: TanStack Query hook for explanation
│   │   ├── useSavedExplanations.tsx         # NEW: Hook for saved explanations
│   │   └── useBookmark.tsx                  # NEW: Mutation hook for bookmarking
│   └── types/
│       └── teaching.ts                      # NEW: TypeScript types for teaching data
│
└── tests/                                   # Testing (to be created)
    ├── unit/
    │   └── teaching/                        # Component unit tests
    │       ├── TopicBrowser.test.tsx
    │       ├── ExplanationView.test.tsx
    │       └── BookmarkButton.test.tsx
    └── e2e/
        └── teaching.spec.ts                 # Playwright E2E tests

backend/                                     # FastAPI + SQLModel (EXISTING - NO CHANGES)
└── src/
    ├── routes/
    │   └── teaching.py                      # ✅ Already exists - no changes needed
    ├── services/
    │   └── teaching_service.py              # ✅ Already exists and operational
    ├── models/
    │   ├── syllabus_point.py                # ✅ Already exists
    │   └── saved_explanation.py             # ⚠️ Check if exists, may need migration
    └── schemas/
        └── teaching_schemas.py              # ✅ Already exists
```

**Structure Decision**: This is a **web application** feature within the existing `frontend/` and `backend/` directories. Frontend follows Next.js 16 App Router structure with routes in `app/(dashboard)/teaching/`. Backend APIs already exist and are operational—no backend code changes required (only verify SavedExplanation model exists or create migration if needed). Reuses established patterns from 004-coaching-page (TanStack Query, shadcn/ui, Tailwind CSS).

## Complexity Tracking

**No violations detected** - Constitution check passed all gates. No complexity justification required.

---

## Phase 0: Research & Technical Decisions

### Research Questions

**Q1: Component Architecture Patterns**
- **Question**: What reusable component patterns from 004-coaching-page apply to teaching page?
- **Why Research Needed**: Avoid reinventing UI patterns (error boundaries, skeletons, toasts already exist)
- **Decision Target**: Identify which components to reuse vs create new

**Q2: TanStack Query Caching Strategy**
- **Question**: What cache configuration for syllabus topics (static) vs explanations (dynamic AI-generated)?
- **Why Research Needed**: Topics rarely change (cache 1 hour), explanations expensive to generate (cache 5 minutes)
- **Decision Target**: Optimal staleTime/cacheTime per query type

**Q3: Collapsible Section UI Pattern**
- **Question**: Use shadcn/ui Accordion component or custom collapsible sections?
- **Why Research Needed**: Spec requires collapsible sections for Examples, Misconceptions, Practice Problems
- **Decision Target**: Choose accessible, keyboard-navigable collapsible component

**Q4: Search Implementation**
- **Question**: Client-side search (fetch all topics, filter locally) or server-side search (API endpoint)?
- **Why Research Needed**: ~200 Economics topics fit in memory, but future subjects may scale (Accounting, Math)
- **Decision Target**: Scalable search pattern for current + future subjects

**Q5: Bookmark Persistence**
- **Question**: Does SavedExplanation model exist in backend? If not, what migration needed?
- **Why Research Needed**: Spec assumes backend API exists (GET /api/teaching/explanations), need to verify
- **Decision Target**: Confirm backend readiness or identify migration tasks

### Research Outputs

**File**: `research.md` (to be created in Phase 0)

Format:
```markdown
# Research: Teaching Page Technical Decisions

## Decision 1: Component Reuse from 004-coaching-page
**Rationale**: [analysis]
**Alternatives Considered**: [other options]
**Choice**: [final decision]

## Decision 2: TanStack Query Caching
[...]
```

---

## Phase 1: Design & Contracts

### Data Model

**File**: `data-model.md` (to be created)

**Entities** (from spec.md):

1. **SyllabusPoint** (backend, already exists)
   - Attributes: id, code, description, learning_outcomes, subject_id, level (AS/A2), paper_number
   - Relationships: belongs to Subject, has many SavedExplanations
   - Frontend Type: `SyllabusTopic` interface

2. **SavedExplanation** (backend, to be verified)
   - Attributes: id, student_id, syllabus_point_id, explanation_content (JSON), date_saved, date_last_viewed
   - Relationships: belongs to Student, references SyllabusPoint
   - Frontend Type: `SavedExplanation` interface

3. **TopicExplanation** (transient, frontend only)
   - Attributes: concept_name, definition, key_terms[], examples[], visual_aids[], worked_examples[], misconceptions[], practice_problems[], related_concepts[], generated_by
   - Not persisted to database (generated on-demand by AI)
   - Frontend Type: `TopicExplanation` interface

**Data Flow**:
```
User searches → GET /api/teaching/syllabus?search=elasticity
                → Returns SyllabusTopic[]

User selects topic → POST /api/teaching/explain { syllabus_point_id, student_id }
                    → Teacher Agent generates TopicExplanation
                    → Returns TopicExplanation (JSON)

User bookmarks → POST /api/teaching/explanations { syllabus_point_id, explanation_content }
               → Backend creates SavedExplanation
               → Returns SavedExplanation

User views saved → GET /api/teaching/explanations?student_id=XXX
                  → Returns SavedExplanation[]
```

### API Contracts

**File**: `contracts/api-endpoints.md` (to be created)

**Existing Backend APIs** (from spec, verify operational):

1. **GET /api/teaching/syllabus**
   - Query params: `?search=keyword` (optional), `?level=AS|A2` (optional), `?paper=1|2` (optional)
   - Response: `{ topics: SyllabusTopic[] }`
   - Cache: 1 hour (topics rarely change)

2. **POST /api/teaching/explain**
   - Body: `{ syllabus_point_id: UUID, student_id: UUID, context?: string }`
   - Response: `{ explanation: TopicExplanation }`
   - Cache: 5 minutes (AI-generated, expensive)

3. **GET /api/teaching/explanations**
   - Query params: `?student_id=UUID` (from JWT)
   - Response: `{ saved_explanations: SavedExplanation[] }`
   - Cache: 1 minute (user-specific, may change frequently)

4. **POST /api/teaching/explanations**
   - Body: `{ syllabus_point_id: UUID, explanation_content: JSON }`
   - Response: `{ saved_explanation: SavedExplanation }`
   - Mutation: Invalidates GET /api/teaching/explanations cache

5. **DELETE /api/teaching/explanations/:id**
   - Path param: `id` (SavedExplanation UUID)
   - Response: `{ success: boolean }`
   - Mutation: Invalidates GET /api/teaching/explanations cache

**Frontend API Client** (to be created):

File: `frontend/lib/api/teaching.ts`

```typescript
export const teachingApi = {
  // Fetch all topics (with optional filters)
  getTopics: async (filters?: { search?: string; level?: 'AS' | 'A2'; paper?: number }) => {
    const params = new URLSearchParams(filters as any);
    const response = await fetch(`/api/teaching/syllabus?${params}`);
    return response.json();
  },

  // Generate explanation for a topic
  explainConcept: async (syllabusPointId: string, context?: string) => {
    const response = await fetch('/api/teaching/explain', {
      method: 'POST',
      body: JSON.stringify({ syllabus_point_id: syllabusPointId, context }),
    });
    return response.json();
  },

  // Fetch saved explanations for current student
  getSavedExplanations: async () => {
    const response = await fetch('/api/teaching/explanations');
    return response.json();
  },

  // Bookmark an explanation
  saveExplanation: async (syllabusPointId: string, explanationContent: any) => {
    const response = await fetch('/api/teaching/explanations', {
      method: 'POST',
      body: JSON.stringify({ syllabus_point_id: syllabusPointId, explanation_content: explanationContent }),
    });
    return response.json();
  },

  // Remove bookmark
  removeSavedExplanation: async (id: string) => {
    const response = await fetch(`/api/teaching/explanations/${id}`, { method: 'DELETE' });
    return response.json();
  },
};
```

### UI Component Contracts

**File**: `contracts/ui-components.md` (to be created)

**Component Hierarchy**:

```
TeachingPage (app/(dashboard)/teaching/page.tsx)
├── TopicBrowser (hierarchical tree)
│   └── TopicCard (individual topic preview)
├── TopicSearch (search bar + results)
│   └── TopicCard (search result item)
└── [if loading] TopicSearchSkeleton

ExplanationPage (app/(dashboard)/teaching/[topicId]/page.tsx)
├── ExplanationView (full explanation display)
│   ├── ExplanationSection (collapsible section)
│   │   ├── Definition (always expanded)
│   │   ├── Key Terms (collapsible)
│   │   ├── Core Principles (always expanded)
│   │   ├── Examples (collapsible, 2-3 items)
│   │   ├── Visual Aids (collapsible, diagram descriptions)
│   │   ├── Worked Examples (collapsible)
│   │   ├── Misconceptions (collapsible)
│   │   ├── Practice Problems (collapsible)
│   │   └── Related Concepts (always expanded)
│   └── BookmarkButton (fixed position or header)
└── [if loading] ExplanationSkeleton

SavedPage (app/(dashboard)/teaching/saved/page.tsx)
└── SavedExplanationsList (list of bookmarked explanations)
    └── TopicCard (with "Remove" button)
```

**Key Component Props**:

```typescript
// TopicCard.tsx
interface TopicCardProps {
  topic: SyllabusTopic;
  onClick: () => void;
  showRemoveButton?: boolean;
  onRemove?: () => void;
}

// ExplanationView.tsx
interface ExplanationViewProps {
  explanation: TopicExplanation;
  isBookmarked: boolean;
  onBookmarkToggle: () => void;
}

// ExplanationSection.tsx
interface ExplanationSectionProps {
  title: string;
  children: React.ReactNode;
  defaultExpanded?: boolean;
  icon?: React.ReactNode;
}

// BookmarkButton.tsx
interface BookmarkButtonProps {
  isBookmarked: boolean;
  onClick: () => void;
  isLoading?: boolean;
}
```

### Quickstart Guide

**File**: `quickstart.md` (to be created)

**User Flow Examples**:

1. **View Explanation Flow** (P1 - Core):
   ```
   User lands on /teaching
   → TopicBrowser displays AS/A2 sections
   → User clicks "3.1.2 Price Elasticity of Demand"
   → Navigate to /teaching/[topic-id]
   → POST /api/teaching/explain
   → Loading: ExplanationSkeleton (5-10 seconds)
   → ExplanationView displays with all sections
   → User reads definition, expands Examples section
   → User scrolls to Practice Problems
   ```

2. **Search Flow** (P2):
   ```
   User types "elasticity" in search bar
   → Client-side filter OR GET /api/teaching/syllabus?search=elasticity
   → Results show: PED, YED, PES topics
   → User clicks "YED" → Navigate to /teaching/[yed-id]
   → [Same as View Explanation Flow]
   ```

3. **Bookmark Flow** (P3):
   ```
   User viewing explanation at /teaching/[topic-id]
   → Clicks "Bookmark" button
   → POST /api/teaching/explanations (saves explanation)
   → Toast: "Explanation saved for later review"
   → Button state changes to "Bookmarked" (checkmark icon)

   Later...
   → User navigates to /teaching/saved
   → GET /api/teaching/explanations
   → SavedExplanationsList displays all bookmarks
   → User clicks on saved explanation → Navigate to /teaching/[topic-id]
   → (Load from cache if available, or re-fetch)
   ```

### Agent Context Update

**Script**: `.specify/scripts/bash/update-agent-context.sh claude`

**Execution**: Run after Phase 1 artifacts created

**Purpose**: Update `CLAUDE.md` with teaching page patterns for future sessions

**Updates**:
- Add teaching page component patterns to `specs/phase-4-web-ui/CLAUDE.md`
- Document TanStack Query hooks for teaching APIs
- Reference collapsible section pattern (shadcn/ui Accordion)

---

## Phase 2: Task Generation

**Command**: `/sp.tasks` (to be run after Phase 1 complete)

**Output**: `tasks.md` with implementation tasks organized by user story

**Expected Task Structure**:

**Phase 1: Setup** (1 task)
- T001: Verify backend APIs operational (GET /api/teaching/syllabus, POST /api/teaching/explain, etc.)

**Phase 2: Foundational** (3 tasks)
- T002: Create TypeScript types for teaching data (lib/types/teaching.ts)
- T003: Create API client (lib/api/teaching.ts)
- T004: Create TanStack Query hooks (useTopics, useExplanation, useSavedExplanations, useBookmark)

**Phase 3: User Story 1 - View Explanation (P1)** (8 tasks)
- T005 [US1]: Create ExplanationView component
- T006 [P] [US1]: Create ExplanationSection collapsible component
- T007 [P] [US1]: Create BookmarkButton component
- T008 [P] [US1]: Create ExplanationSkeleton loading state
- T009 [US1]: Create explanation page route (app/(dashboard)/teaching/[topicId]/page.tsx)
- T010 [US1]: Integrate useExplanation hook in page
- T011 [US1]: Add error boundary for explanation route
- T012 [US1]: Test explanation display with real backend

**Phase 4: User Story 2 - Browse/Search Topics (P2)** (6 tasks)
- T013 [P] [US2]: Create TopicCard component
- T014 [P] [US2]: Create TopicBrowser hierarchical tree
- T015 [P] [US2]: Create TopicSearch search bar + results
- T016 [P] [US2]: Create TopicSearchSkeleton loading state
- T017 [US2]: Create main teaching page route (app/(dashboard)/teaching/page.tsx)
- T018 [US2]: Integrate useTopics hook + search filtering

**Phase 5: User Story 3 - Bookmark Explanations (P3)** (4 tasks)
- T019 [P] [US3]: Create SavedExplanationsList component
- T020 [US3]: Create saved explanations page route (app/(dashboard)/teaching/saved/page.tsx)
- T021 [US3]: Integrate useBookmark mutation in BookmarkButton
- T022 [US3]: Test bookmark/unbookmark flow end-to-end

**Phase 6: Polish & Testing** (8 tasks)
- T023 [P]: Unit tests for TopicBrowser, ExplanationView, BookmarkButton
- T024 [P]: E2E test: View explanation flow (Playwright)
- T025 [P]: E2E test: Search topics flow (Playwright)
- T026 [P]: E2E test: Bookmark flow (Playwright)
- T027: Accessibility audit (WCAG 2.1 AA compliance)
- T028: Performance testing (Lighthouse >90 score)
- T029: Mobile responsive testing (375px+)
- T030: Update specs/phase-4-web-ui/CLAUDE.md with teaching page patterns

**Total**: ~30 tasks (fewer than 004-coaching-page due to reusable patterns)

---

## Implementation Notes

### Reusable Patterns from 004-coaching-page

**Already Established** (no need to recreate):
- Error boundaries (frontend/components/coaching/ErrorBoundary.tsx) → Reuse for teaching routes
- Toast notifications (frontend/components/ui/toast.tsx) → Reuse for bookmark feedback
- Skeleton loading (frontend/components/ui/skeleton.tsx) → Adapt for ExplanationSkeleton
- TanStack Query setup (frontend/app/providers.tsx) → Already configured
- shadcn/ui components (Accordion, Card, Input, Button) → Reuse for teaching UI

### New Patterns to Establish

**Collapsible Sections**:
- Use shadcn/ui Accordion component (already installed from 004-coaching-page)
- Keyboard navigation: Enter to expand/collapse, Tab to navigate between sections
- Screen reader: Announce "Expanded" / "Collapsed" state changes

**Typography for Educational Content**:
- Headings: `text-2xl font-bold` (concept name), `text-xl font-semibold` (section titles)
- Body text: `text-base leading-relaxed` (readable line height for long explanations)
- Economic terms: `font-semibold` (e.g., "Price Elasticity of Demand")
- Definitions: Quote blocks with `border-l-4 border-primary pl-4 italic`
- Code/math: `font-mono bg-muted px-1 rounded` (inline), `<pre>` blocks for formulas

**Search UX**:
- Debounce search input (300ms delay to avoid excessive filtering)
- Highlight matching keywords in search results (use `<mark>` tag with Tailwind)
- Show "No results" with suggestion to refine query
- Clear search button (X icon) when input has text

### Backend Verification Checklist

**Before implementation, verify**:
1. ✅ GET /api/teaching/syllabus returns Economics 9708 topics
2. ✅ POST /api/teaching/explain generates TopicExplanation successfully
3. ⚠️ SavedExplanation model exists in backend (check backend/src/models/)
4. ⚠️ GET /api/teaching/explanations endpoint operational
5. ⚠️ POST /api/teaching/explanations creates bookmarks
6. ⚠️ DELETE /api/teaching/explanations/:id removes bookmarks

**If any ⚠️ items fail**: Create Alembic migration for SavedExplanation model (add to tasks.md)

### Technology Decisions

**Caching Strategy** (TanStack Query):
- Syllabus topics: `staleTime: 1 hour, cacheTime: 2 hours` (static data)
- Explanations: `staleTime: 5 minutes, cacheTime: 10 minutes` (AI-generated, expensive)
- Saved explanations: `staleTime: 1 minute, cacheTime: 5 minutes` (user-specific, may change)

**Search Implementation**:
- **Decision**: Client-side search (fetch all topics, filter locally)
- **Rationale**: ~200 Economics topics fit in memory (<100KB), instant results, no server load
- **Future**: If topics exceed 1000 (when adding more subjects), switch to server-side search

**Collapsible Sections**:
- **Decision**: shadcn/ui Accordion component
- **Rationale**: Accessible (ARIA labels, keyboard nav), customizable with Tailwind, already installed
- **Default State**: Definition, Core Principles, Related Concepts expanded by default; Examples, Misconceptions, Practice collapsed

**Bookmark Persistence**:
- **Decision**: Store full explanation JSON in SavedExplanation.explanation_content
- **Rationale**: Enables offline viewing (future PWA), avoids re-fetching AI explanation
- **Tradeoff**: Larger database storage (~5-10KB per bookmark), but better UX

---

## Post-Design Constitution Re-Check

**Re-evaluate after Phase 1 complete**:

✅ **Principle I: Subject Accuracy** - No changes. Syllabus data from backend already verified.

✅ **Principle IV: Spec-Driven Development** - Spec exists, plan complete, tasks next.

✅ **Principle V: Multi-Tenant Isolation** - All API calls include JWT with student_id. SavedExplanation model filters by student_id.

✅ **Principle IX: SpecKitPlus Compliance** - Following workflow: /sp.specify ✅ → /sp.plan ✅ → /sp.tasks (next).

✅ **Principle XI: CLAUDE.md Hierarchy** - Teaching page patterns documented in specs/phase-4-web-ui/CLAUDE.md (T030 task).

**FINAL GATE STATUS**: ✅ **PASS** - No violations introduced during design phase.

---

## Next Steps

1. **Complete Phase 0**: Create `research.md` with technical decisions
2. **Complete Phase 1**: Create `data-model.md`, `contracts/`, `quickstart.md`
3. **Verify Backend**: Test all 5 backend API endpoints, confirm operational
4. **Run `/sp.tasks`**: Generate task breakdown organized by user story
5. **Update CLAUDE.md**: Document teaching page patterns (after implementation)
6. **Execute `/sp.implement`**: Build teaching page following tasks.md

**Estimated Timeline**: 2 days (Dec 24-25)
- Day 1: Setup + US1 (View Explanation) + US2 (Browse/Search)
- Day 2: US3 (Bookmark) + Polish + Testing

---

**Version**: 1.0.0 | **Created**: 2025-12-23 | **Status**: Phase 1 Design In Progress
